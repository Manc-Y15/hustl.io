{% extends 'base/base_layout.html' %}
{% load static %}
{% block content %}
<link rel="stylesheet" href="{% static 'css/profile.css' %}"> 

<div class="container" style="margin-top: 20px;max-width:800px;">
	<div class="row">
		<div class="container-lg" style="margin-top: 20px;">
			<div class="row" style="border-bottom:1px solid #95a5a6">
				<h2 style="text-align: left;">Friends</h2>
			</div>
			<div class="row">
				<div class="col-sm-7 col-12" style="padding-top: 20px;">
					<div class="grid">
						<form hx-post="/friends/search" hx-swap="innerHTML">
							{% csrf_token %}
							<div class="profile-input row" style="margin-bottom: 45px; padding: 10px;">
								<input class="profile-search col-10" placeholder="Find friends">
								<button class="btn btn-link col-2" name="Friend_search" type="submit" style=" padding-left: 1em; padding-top: 0.4em;">
									<i class="fas fa-search" style="font-size:1.5em; color: var(--clouds);"></i>
								</button>
							</div>
						</form>
						
						<div class="row" style="border-bottom:1px solid #95a5a6">
							<h3 style="text-align: left;">My friends</h3>
							</div>
							{% for friend in friends %}
							<div class="profile-input row" id={{ friend.0 }}>
								<h4 class="profile-input-text col-10 flex-wrap">
									<span style="color: #f39c12">{{ friend.0 }}</span>&nbsp;worth&nbsp;
									<span style="color: #2ecc71">${{ friend.1 }}</span>
								</h4>
								<button class="btn btn-link col-2" type="button" onclick="displayFriendInfo(this);">
									<i style="color: var(--clouds);font-size: 1.5em;" class="fa fa-solid fa-bars" style="pointer-events: none; color: white"></i>
								</button>
								<div class="profile-input row" id="{{friend.0}}_child" style="box-shadow: none; display: none;">
									<h4 class="profile-input-text col-6">Friends since:</h4>
									<h4 class="profile-input-text col-6">{{ friend.2 }}</h4>
									<h4 class="profile-input-text col-6">Head to head:</h4>
									<h4 class="profile-input-text col-6 flex-wrap">
										{% if friend.3 == 'Losing' %}
										<span style="color: var(--alizarin);">
										{% else %}
										<span style="color: var(--emerald);">
										{% endif %}
									{{friend.3}}</span>&nbsp;by&nbsp;<span style="color: #2ecc71">${{friend.4}}</span></h4>
									<div class="justify-content-center" style="padding: 0;">
										<button style="margin-top: 10px;" class="default-button col-6" type="button" name="view_profile" onclick="viewProfile(this);">View profile</button>
										<button style="margin-top: 10px;" class="remove-friend-button col-6" type="button" name="Remove_friend" onclick="removeFriend(this);">Remove friend</button>
									</div>
								</div>
							</div>
							{% endfor %}
						</div>
					</div>
					<div class="col" style="margin-left: 10px;padding-top: 20px;">
						<div class="grid">
							<div class="row justify-content-center">
								{% for league in leagues %}
								<div class="league-preview col-sm-12 col-6">
									<h4 class="league-preview-text" style="padding-bottom: 10px;">{{league.0}}</h4>
									{% for user in league|slice:"1:" %}
									{% cycle '1' '2' '3' as position silent %}
									<div class="league-preview-row row">
										<h5 class="league-preview-text col-9 col-md-8">{{position}}. {{user.0}}</h5>
										{% if user.1 == 'Up' %}
										<i class="fa fa-solid fa-caret-up col" style="font-size: 1.5em; color: var(--emerald);"></i>
										{% elif user.1 == 'Down' %}
										<i class="fa fa-solid fa-caret-down col" style="font-size: 1.5em; color: var(--pomegranate);"></i>
										{% else %}
										<i class="fa fa-solid fa-equals col" style="font-size: 1em; color: var(--river);"></i>
										{% endif %}
									</div>
									{% endfor %}
								</div>
							{% endfor %}
							</div>
							<a href="leagues.html" class="default-button row justify-content-center" style="padding-top: 0.488em;padding-bottom: 0.488em; max-width: 200px; max-height: 160px; margin-top: 10px; margin-left: 0;">View all leagues</a>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
</div>

<script type="text/javascript">
    function displayFriendInfo(ele){
        var friendID=ele.parentElement.id;
        childID=friendID+"_child"
        if(document.getElementById(childID).style.display=="flex"){
            document.getElementById(childID).style.display="none";
        }else{
            document.getElementById(childID).style.display="flex";
        }
    }
    function removeFriend(ele){
        var friendID=ele.parentElement.parentElement.parentElement.id;
        alert("Remove "+friendID+" from friends");
    }
    function viewProfile(ele){
        var friendID=ele.parentElement.id;
        alert("View "+friendID+"'s profile");
    }
    function addFriend(ele){
        var friendID=ele.parentElement.id;
        alert("Add "+friendID+" from friends");
    }
</script>
<script src="https://unpkg.com/htmx.org@1.7.0"></script>

{% endblock %}